[sim]
modelname = functional-test
max_steps = 400
output_step_interval = 100

has_output_during_remeshing = no
is_outputting_averaged_fields = no

checkpoint_frame_interval = 2

[mesh]
meshing_option = 1
meshing_elem_shape = 1
xlength = 250e3
ylength = 10e3
zlength = 125e3
resolution = 5e3

quality_check_step_interval = 5
min_quality = 0.2
max_boundary_distortion = 2e-3

remeshing_option = 13

[markers]
markers_per_element = 8

[control]
surface_process_option = 1
surface_diffusivity = 2e-5

dt_fraction = 1.0
inertial_scaling = 1e4
surf_base_level = 15.e3
gravity = 9.81

[bc]
vbc_x0 = 1
vbc_x1 = 1
vbc_val_x0 = -1.57e-10
vbc_val_x1 = 1.57e-10

vbc_y0 = 1
vbc_y1 = 1
vbc_val_y0 = 0
vbc_val_y1 = 0

has_water_loading = yes

surface_temperature = 273
mantle_temperature = 1723

[ic]
mattype_option = 1
num_mattype_layers = 2
layer_mattypes = [0,1]
mattype_layer_depths = [0.24]

temperature_option = 3
num_radiogenic_heat_layer = 3
radiogenic_heat_boundry = [-1, 6e3, 8e3, -1] # upper crust, lower crust, lithospheric mantle
radiogenic_heat_mat_in_layer = [0, 0, 1]
rh_dome_amplitude = 10.e3
rh_dome_width = 30.e3
surface_heat_flux = 70e-3

weakzone_option = 1
weakzone_azimuth = 15
weakzone_inclination = -60
weakzone_halfwidth = 1.2
weakzone_depth_min = 0.
weakzone_depth_max = 1.0
weakzone_xcenter = 0.5
weakzone_ycenter = 0.5
weakzone_zcenter = 0
weakzone_plstrain = 0.5

[mat]
rheology_type = elasto-visco-plastic
num_materials = 4
mattype_ref = 0

mattype_crust = 0
mattype_mantle = 1
mattype_asthenosphere = 2
mattype_sed = 3

# continental crust, lithospheric mantle, asthenosphere, sediment
rho0 = [ 2750, 3300, 3300, 2400]
alpha = [ 3e-5 ]
bulk_modulus = [ 4.3e10, 6.7e10, 6.7e10, 5.5e10 ]
shear_modulus = [ 3.5e10, 6.7e10, 6.7e10, 3.6e10 ]

visc_exponent =          [    3.05,    3.5,    3.5,    4.0 ]
visc_coefficient =       [ 1.25e-1, 1.1e+5, 1.1e+5,   5.e2 ]
visc_activation_energy = [  2.76e5, 5.30e5, 5.30e5,  4.3e5 ]
visc_activation_volume = [  27.E-6, 27.E-6, 27.E-6, 27.E-6 ]

radiogenic_heat_prod =   [ 4e-10, 2e-11, 0.00E+00, 0 ]
heat_capacity = [ 1000 ]
therm_cond = [ 3.3 ]
pls0 = [ 0 ]
pls1 = [ 0.1, 5, 5, 0.1 ]
cohesion0 = [ 4e7, 4e7, 4e7, 4e7 ]
cohesion1 = [ 4e6 ]
friction_angle0 = [ 30, 30, 30, 30 ]
friction_angle1 = [ 20, 30, 30, 15 ]
dilation_angle0 = [ 0 ]
dilation_angle1 = [ 0 ]

max_viscosity = 1e24
min_viscosity = 1e19
